function [Y,Xf,Af] = simpleNN_S(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-Dec-2021 16:20:05.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx5 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.50826608;0.75224505;0.25240559;0.7524299;0.250911845];
x1_step1.gain = [0.33388061039706;0.400593992760585;0.364089031557419;0.400510983928626;0.363726553603256];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.4447718364673463043;-2.3264666216781360042;-3.2323634353631844895;1.4508435548582143682;7.9510034725124905108;-0.25541685302887118247;4.5502108163644097161;-2.4215137266810571326;-0.34170589499354092622;-0.62945224181220971182;2.4579049885098926964;2.6021215356043105871;1.0663838796019053934;4.6396202859609161351;-1.3121886533320721302;1.1086605420270123634;-0.3961133447476369307;0.64847804039264345111;-2.8213039926625986809;0.50625761219758125264;0.91998666541950480102;-1.3960507416254730462;0.91082335316351381582;-1.5682328449967062323;-0.92632812867472913432;0.62682947752301532152;-2.676697154747259777;-4.7341025039328137325;2.2533940576044879656;-0.19695391742412962643;-0.77825049405073731812;-0.72704977130809878005;-1.8652872915892919625;2.5456865313636023451;0.35161566556154139063;0.7211799369920748326;0.32981315061094707008;-1.6869597037965777808;-0.9503176031070463825;-0.66766480622782486964;1.8024795378413092095;-0.33677294589804795955;3.7183824489270662639;-3.1095440251366293083;-2.4152213494592893461;-4.0680901089601713139;2.4489340249099731395;-0.64282901245266099721;-4.1575912126009777481;5.5666136517604636325];
IW1_1 = [-4.1682090736395727149 2.5418827867739310911 1.5817680275037449 4.2469789752246782655 1.9557852462476734701;1.3951499731247967162 -0.45454694569486614464 0.86822155330634553927 -1.2692521625225294812 -0.93783144759418868297;0.89476517383032561082 0.88734993678463180977 -1.5526829492337888006 -1.0377474581940022702 2.0536673165297418819;0.65348516860312610977 -2.4604468287891556599 2.1757603570188819297 0.43708329464969503109 -0.53678500422163888395;-0.86509778452754115818 -2.2679399872262999693 -2.031744949528864197 1.7357075619057482641 5.7568386362862069561;-0.93914428625560764097 -1.3712131864092012012 0.79169700389516706185 -1.5415342192388394871 1.3258473025980741511;-5.5451506976531472759 -6.3788018679372280317 -5.8347665030518571783 -2.7675847821176580155 0.51147353651685412146;4.7771056120879880069 1.9212192238512599829 -4.7709778198944050587 3.6137140982823616753 -2.3984949320065136469;-2.9474771921704960853 2.639502156417523171 1.2939566083994655799 -1.010039100215117891 -0.97204373751527517467;5.4963319613434160615 10.684790198032976249 4.1549419094424200338 -3.5444552287029349458 -1.8130858594148850926;-3.3213440122892086137 -2.5952585211022074496 -1.5312107542433914809 1.2203032058850125097 -3.8096805860452196413;-0.19874150911235211048 -1.2907115374260800245 0.7578005681983106534 -2.8595082148479029627 3.6409782147562514965;0.22678334136748945493 0.021318701796380956637 0.73231231611587632724 0.83702749589057867663 0.58445596106542674342;0.87435614832432295707 -0.63217005960604799597 -1.5970093109640659534 4.7894741583909468119 2.4618349884039600894;1.3399889980320049965 0.96289844061661811203 -3.4783826261601542562 -0.3663763961219070886 -2.6925521912368641786;-1.9580836851704463974 0.11339465885840208093 0.22210543372538052442 0.27854004055729308931 -1.0700046185123341935;-0.27995961166534555353 -0.005497179875329660792 -0.37716478089242960747 0.8694378496984371818 -0.42709697135323576589;4.5868042442915681889 5.4557839825569960368 1.1447405792235254562 -1.9638518051656859154 -0.16320184724491951234;1.3091413552815287513 -2.1146650929114301221 5.2851502139083752496 3.5827239401790325068 -3.9758069998132770095;-1.2331872871768787547 -1.4077532946106270373 1.1021642724863742746 -0.94779301522668590874 0.93048768845493112778;1.2261210875297186007 2.6998318014259856668 -1.1475393963163291744 1.9219087266635839217 1.7712970230391542614;2.5761999818966847542 2.7814793034058826748 2.6293646302162367867 3.114678192060041706 3.946635244549082433;-2.7567850981081036821 -2.3253710027472083155 4.6278174487796119863 -5.6926020069862390827 0.84886598286696979265;0.32249692012722247503 -6.0031872282395859486 2.6270793928380316018 -4.5417138627207283008 3.1961625080985665015;-0.18767576439800770505 0.40464393299708945051 1.7393489587795007978 0.42233533024016245427 -1.1431649890919430845;-0.11843682810660355331 0.20401237372271785464 0.26808540451177964581 0.083245730907854892378 -0.26218785040917008677;-2.725640819478535537 0.40185857641044614441 -0.95192092135731354308 4.2624701952741217426 1.4254596952144551469;-1.1595950335184621593 -7.9454798056532656148 -6.1294365057144970521 1.5625574144243707941 0.57814851559629309996;-0.3608710826594729304 3.0513380188480185851 -1.3520547394716846412 -2.0891625457832998514 -4.4647568228649587851;-0.38842755866399353293 -1.5257793007627824533 0.42363845882158501777 -1.6224729022383730381 -1.7577360046174987929;-0.21237712823573690057 1.0749516481796745904 1.8958846482565716585 1.6786779680107064561 1.4734245180247946827;-0.94073978490587939483 -1.0565271872013537457 1.8788628952807870931 0.16723167805072547409 -0.61740511551444499094;0.96930377720851568224 -2.3251294686291683611 5.1538886883938577199 2.8992875333818002304 1.8585780866238525988;6.5531670657000606894 -5.0841021927554566062 -3.253748970965505638 2.3557707158753293797 5.3384619785858555829;0.29197670059951091881 -1.7236126095396717695 6.4008262396757311663 -0.052869691881488600771 -0.23581661327355293856;1.8681213285954658687 0.19122903193814833056 0.14480376675020711907 0.61415362843576681851 3.0730590920647662401;1.1305710231292045442 2.9798008028314253437 -1.2445237187182298655 0.83177680639178364075 -2.5356277669099211991;-1.0117210451517388847 -1.3555248225578386823 2.4751783941604550421 -0.76169494559419548274 -0.032628616576598462595;4.740650724777466074 4.5984946870858767198 3.5636847685996877466 1.2245462059570328961 1.0627618676310617296;-0.1106195722132393422 -0.23355281920812501206 -0.90634723404631500898 -0.048041728702593766709 -0.27089988099079642669;4.4697990978512640581 0.093742546537248949701 -0.92395242845249714314 1.9192266555966854824 -0.59701470256582622742;-0.74558870460900983357 -1.9950275547754627858 -0.81124993823200974852 -0.3900115285361684947 -0.025710130393695296291;-1.8697275538640534265 -5.5777367539705640098 -0.72402876907771329673 -1.6651438178412454327 1.9735155813844951211;-2.6086153311015469747 -2.7404230576620580706 -1.750693307052379577 3.3282500694353647219 -4.8089712148495600275;1.4906860392289513761 -2.2884621946697940587 0.47462026702938647782 -2.7221984173941868868 -0.37797990471078618535;-0.63512958206072900325 -2.8951267962024229696 2.7846603243833856212 -1.4948789706504987951 -0.99398735086005896022;0.8358403133390693851 1.6891750553072599761 -2.1089885962165415556 -2.0141055986440998815 -5.6244343845992359476;-7.6318273929634656838 -4.8318226836207625041 -10.334317723624979024 -2.7436476556316682363 -2.2454408937250533995;-0.2278054705950213199 4.1808154492149425252 -5.4743425380992460916 -0.184222831007282567 -0.46526892882578807509;4.2421412507396984992 9.8323758295777921035 6.5965462723952068558 -1.4946201241108805213 -1.5263269202189180263];

% Layer 2
b2 = [-2.1044261197332900792;0.56276188052873410417;0.69193004311133754491];
LW2_1 = [-0.030336535880642667706 -0.056039902042742749388 0.36085597086135351441 0.48866082200590577056 0.0102889822954747856 -0.51862699438457182666 -0.27975632334528305334 -0.047436559290216784301 0.026762843391520393932 0.22133375572801536335 0.31827917195611210577 -0.41055744659489329385 0.073874783738018534596 -0.34424502990603433883 -0.13642426596776324743 0.0099534001820245389391 -1.0048713462678744435 -0.025318620904256849968 -0.026081332949036424573 -0.37556210909545595378 -0.23155985021013739122 -0.071448570988844550822 -0.032994289126744555385 0.051002342597788775935 0.16083618807276456319 3.8632216182782443958 -0.18323044649601755163 -0.059710821076083678283 -0.47011610847982998607 -0.2889284037713992781 0.51243600429878188862 -0.36396494924499750434 0.015200984023911831566 0.14163417950678958146 -0.28631235217827666339 -0.36680673337229741104 -0.33841435985680634602 -0.64218875523334006949 -0.32323502319704244812 0.56474699907530634402 -0.066264202116433065792 0.51407502993524423207 0.61859394039285642286 -0.42286235137863636968 0.074281524999940895526 0.12214031257098736938 0.14759866370388613488 -0.066801827128701876668 0.32501068401566446386 -0.063448246000879879314;0.10854276180591186651 0.18695673529549944325 1.0128905603987701234 0.0023713422739229175762 0.19019294926332119822 -0.45708664386809300106 -0.059315487875708339249 -0.01982469491480485374 -0.10281685336970092237 0.095713241144682714712 0.18698466817255660066 -0.062933060381354433144 0.10900785219010121485 -0.086036058740760937291 -0.10350051989844155642 0.56382915354701479416 -0.27806342851226928392 -0.053256819514914316427 -0.017848068205989692236 0.41656043482869542505 0.17825836555823915131 -0.090533129938662970648 -0.025740333361750397656 0.1890146427694973652 0.039667448710569569448 0.52225628844595917144 -0.31326261675933014805 -0.013534613130631201194 -0.071168222782235474044 0.0078427046439091679941 0.12935707102964316695 -0.34090151185854572491 0.10230460898854527863 0.0024345377113397723146 -0.13582924380277225374 0.069915935963163797218 -0.0018537452161906109449 0.12736294522870583723 0.022741079278333520275 0.64834019832230516123 0.058448701066409203264 -0.16436396797923752411 -0.16175665163647251488 0.060190764911710631369 0.32930714868057758826 -0.13928226764602019694 -0.092961267095038296882 -0.059509663364962668564 -0.025693017404758107525 -0.094450708596508170523;-0.095906773698039599063 -0.078373749982505847012 -0.83156361446387083713 0.24333893698900235791 -0.25863650392163151093 0.31661454592936261188 0.063775842249286895935 -0.061671803620750635655 -0.001476058239378269521 0.2159216093839992634 -0.075073309495977208483 -0.1324632222461357145 0.021401817049319982189 0.17029814652275374054 -0.0073156767559848685789 0.21016064618050572799 -0.24783003971761971562 -0.033763243021928249221 -0.17832969967895742625 -0.19471881916549280134 0.011451369451269094446 0.28137973741734656485 -0.084373211075543519399 -0.038806104425692516946 0.59075769811051603853 -2.9592325567114743379 0.23224020507265152879 0.077482983622359086207 0.10218186305466696318 0.28907326809289257685 -0.16047703301096691297 0.16832380845543110093 0.072225818232781138772 0.035869041097848927691 -0.26234613341312151835 0.18521231266110360636 0.1163228871188017044 -0.083177508486260876008 0.26035320642158743532 -0.33445948749209652995 0.02780100096433264778 0.3852106062518317886 0.26610043470146421685 0.41189370845812700583 -0.37199381987449614551 -0.081504512391488051493 0.055501306388469881514 0.00379761730184053313 0.082078247944954052517 0.41384250127460203705];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [8.91640274006816e-08;2.9390385124046e-08;6.75991215129124e-08];
y1_step1.xoffset = [-9036479.67;-70372832.1;-15406127.1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
