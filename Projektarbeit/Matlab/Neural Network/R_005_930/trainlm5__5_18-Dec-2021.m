function [Y,Xf,Af] = trainlm5__5_18-Dec-2021(X,~,~)
%TRAINLM5__5_18-DEC-2021 neural network simulation function.
%
% Auto-generated by MATLAB, 18-Dec-2021 18:45:33.
% 
% [Y] = trainlm5__5_18-Dec-2021(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.50826608;0.75224505;0.25240559;0.7524299;0.250911845];
x1_step1.gain = [0.33388061039706;0.400593992760585;0.364089031557419;0.400510983928626;0.363726553603256];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.6349161393943043574;0.24216553960102785159;0.85841349678151046554;0.63021291078303420807;1.4672420169170068416];
IW1_1 = [0.6247133588799727022 0.3246194654867151641 -0.1912064215844122006 -0.95495749080834646527 0.75995747723429030174;-0.015940949330111933713 -0.27259094686803825303 0.13436424055732076877 -0.5713663161666270307 0.19213046324426044653;-1.9017686713813377608 0.27490090060521327198 -1.0413441845273505582 1.6942478571789181263 -0.78381478863974562987;0.75125168552907317654 -1.3206823673317491519 1.9026255293095541976 -0.43433955677754931823 -0.29434563132752761261;1.0724525005977136871 -0.36293387018321821014 -0.16537234019638855087 -3.4711408529048632943 0.86717183350746163129];

% Layer 2
b2 = [-0.23886681540065626828;-1.7567525261136422987;1.1268705853548000029;1.9440396432866344778;2.5736665500671809248];
LW2_1 = [-0.63306529799464728026 3.1680429481344534182 1.6746401881653318888 -0.37458082236812917376 -0.69003025244756766021;3.2819063451382519681 -3.4060769096642444786 -1.9661109253272754938 0.84673095751096194572 0.33922592258313344349;1.5859516640278523703 8.425472704314099559 -6.9275040810450452256 -2.1489432511790242941 -10.707352442948231186;3.3464665454243043285 2.2872461757333968357 0.41913498991110187397 -4.0145537608011574449 -0.80585886668546991007;4.5869324565053126719 0.91981865200446055741 -1.9914241073617815481 0.6872113356562717934 3.063211887300458347];

% Layer 3
b3 = [0.32991299365613085959;-0.93306617357813648184];
LW3_2 = [-4.3780590820084510639 -3.6599762197834366795 -0.021862608483340619653 -0.19008884592056951579 -0.24488830612816991916;-2.6671997139977650093 -3.3182342579593777643 0.82135834363750181986 -1.1557191645710407357 2.6855166566060963973];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.585808911511449;0.568900823163935];
y1_step1.xoffset = [-1.78720142;-6.54522631];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
