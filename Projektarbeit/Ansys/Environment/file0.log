/BATCH  
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       12:39:39
/input,menust,tmp,''
/GRA,POWER
/GST,ON
/PLO,INFO,3
/GRO,CURL,ON
/CPLANE,1   
/REPLOT,RESIZE  
WPSTYLE,,,,,,,,0
/NOPR   ! Suppress printing of UNDO process 
/PMACRO ! Echo following commands to log
FINISH  ! Make sure we are at BEGIN level   
/CLEAR,NOSTART  ! Clear model since no SAVE found   
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       12:43:22
!* Material Parameter und Materialmodelle   
/PREP7  
!*  
ET,1,PLANE182   
!*  
KEYOPT,1,1,0
KEYOPT,1,3,3
KEYOPT,1,6,0
!*  
R,1,0.5,
!*  
!*  
MPTEMP,,,,,,,,  
MPTEMP,1,0  
MPDATA,EX,1,,6E7
MPDATA,PRXY,1,,0.2  
!Create House   
BLC4,0,0,8,8
BLC4,1,0,1,2
BLC4,5,5,1.5,1.5
BLC4,2.5,5,1.5,1.5  
FLST,3,3,5,ORDE,2   
FITEM,3,2   
FITEM,3,-4  
ASBA,       1,P51X  
!Meshing
FLST,2,1,5,ORDE,1   
FITEM,2,5   
AESIZE,P51X,10, 
MSHAPE,0,2D 
MSHKEY,0
CM,_Y,AREA  
ASEL, , , ,       5 
CM,_Y1,AREA 
CHKMSH,'AREA'   
CMSEL,S,_Y  
!*  
AMESH,_Y1   
!*  
CMDELE,_Y   
CMDELE,_Y1  
CMDELE,_Y2  
!*  
FINISH  
/SOL
FLST,2,2,4,ORDE,2   
FITEM,2,17  
FITEM,2,-18 
!*  
/GO 
DL,P51X, ,ALL,0 
FLST,2,1,4,ORDE,1   
FITEM,2,3   
/GO 
!*  
SFL,P51X,PRES,10,   
/STATUS,SOLU
SOLVE   
FINISH  
/POST1  
/SHOW,WIN32C
SET,FIRST   
/PLOPTS,INFO,3  
/CONTOUR,ALL,18 
/PNUM,MAT,1 
/NUMBER,1   
/REPLOT,RESIZE  
PLNSOL,U,SUM
PLNSOL,S,INT
! /UIS,ABORT,1  
/SHOW,WIN32 
/REPLOT,RESIZE  
!!!!!!!!!!Code Snipplet to write a Matrix which can be imported in Matlab   
*dim, c,, 10,10, 1 ! Example Matrix 
*SET,enow , 0   
*do, ct, 1, 10  
*do, ct2, 1, 10 
*SET,c(ct,ct2) , ct*ct2 
*enddo  
*enddo  
!!! Writes out Matrix to matlab 
*dmat, exportmatrix, D, import, APDL, c ! export to matrix file 
*export, exportmatrix, mmf, mytemp.mtx  
!adiv = ' | '   
!*dim,nds, ,10  
!*dim,temps,,10 
!*vfill,nds(1),ramp,1,1 
!*vfill,temps(1),rand,70,1500   
!*cfopen,vw1.out
!*VWRITE,'Temp: ',nds(1),temps(1),adiv, 'TREF: ',70 
! (A6,F8.0,g16.8,A3,A6,F10.4)   
!*cfclose   
!========================================================   
! Wandscheibe mit �ffnungen   
! Einheiten: [kN],[m]   
!========================================================   
/nerr,0 
*do,j,1,10,1
/com,   
*enddo  
/COM *** 5.2.2 ANSYS APDL ***   
finish  
/clear,start
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       12:47:38
/input,start,ans,'C:\Program Files\ANSYS Inc\v201\ANSYS\apdl\'  
meshsize=1  
verfein=1   
steps=1 
*DIM,results,TABLE,steps,6  
*TAXIS,results(1,1),1,1.,2.,3.,4.,5.,6.,7.,8.,9.,10.,   
*TAXIS,results(1,1),2,1.,2.,3.,4.,5.,6. 
! *** loop to restart the calculation ***   
!------------------------------------------------   
*do,j,1,steps,1 
/com,  %j%  %meshsize%  
*SET,results(j,1) , meshsize
parsav,all  
finish  
/clear,start
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       12:47:43
/input,start,ans,'C:\Program Files\ANSYS Inc\v201\ANSYS\apdl\'  
parres  
/prep7  
blc4,0,0,10,10  
blc4,5,0,5,5
asba,1,2
ET,1,PLANE182   
KEYOPT,1,1,0
KEYOPT,1,3,3
KEYOPT,1,6,0
r,1,0.2 
mp,ex,1,30000000
mp,prxy,1,0.2   
dl,9,,all   
sfl,3,pres,250  
esize,meshsize  
amesh,all   
cpintf,all  
FINISH  
/SOL
solve   
FINISH  
/POST1  
! maximale Verschiebung bei 10;10   
allsel  
nsel,s,loc,x,10 
nsel,r,loc,y,10 
*get,u,NODE,NDNEXT(0),u,y   
*SET,results(j,3) , u   
PATH,hori,2,30,5000 
PPATH,1,0,0,3,,0,   
PPATH,2,0,5,3,,0,   
PDEF,sy,S,Y,NOAVG   
PCALC,INTG,intsy,SY,XG,1,   
PAGET,array_hori,TABL   
*SET,syh,array_hori(5001,6) 
*DEL,array_hori 
*SET,results(j,4),syh   
allsel  
*get,nn,NODE,0,count
*SET,results(j,2),nn*2  
!! Netzgroesse anpassen 
*SET,meshsize , meshsize/verfein
*enddo  
*do,j,1,steps,1 
/com,  %j%   %results(j,1)%   %results(j,2)%   %results(j,3)%   %results(j,4)%   %results(j,5)%   %results(j,6)%
*enddo  
/gcol,1,max_u   
*VPLOT,results(1,2),results(1,3)
weiter=1
/gcol,1,GG  
*VPLOT,results(1,2),results(1,4)
weiter=1
*do,j,1,steps,1 
/com,  %j%   %results(j,1)%   %results(j,2)%   %results(j,3)%   %results(j,4)%   %results(j,5)%   %results(j,6)%
*enddo  
*dmat, exportmatrix, D, import, APDL, result ! export to matrix file
/BATCH  
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       13:36:54
/input,menust,tmp,''
/GRA,POWER
/GST,ON
/PLO,INFO,3
/GRO,CURL,ON
/CPLANE,1   
/REPLOT,RESIZE  
WPSTYLE,,,,,,,,0
!!!!!!!!!!Code Snipplet to write a Matrix which can be imported in Matlab   
*dim, c,, 10,10, 1 ! Example Matrix 
*SET,enow , 0   
*do, ct, 1, 10  
*do, ct2, 1, 10 
*SET,c(ct,ct2) , ct*ct2 
*enddo  
*enddo  
!!! Writes out Matrix to matlab 
*dmat, exportmatrix, D, import, APDL, c ! export to matrix file 
*export, exportmatrix, mmf, mytemp.mtx  
!========================================================   
! Wandscheibe mit �ffnungen   
! Einheiten: [kN],[m]   
!========================================================   
/nerr,0 
*do,j,1,10,1
/com,   
*enddo  
/COM *** 5.2.2 ANSYS APDL ***   
finish  
/clear,start
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       13:58:14
/input,start,ans,'C:\Program Files\ANSYS Inc\v201\ANSYS\apdl\'  
meshsize=1  
verfein=2   
steps=2 
*DIM,results,TABLE,steps,6  
*TAXIS,results(1,1),1,1.,2.,3.,4.,5.,6.,7.,8.,9.,10.,   
*TAXIS,results(1,1),2,1.,2.,3.,4.,5.,6. 
*dim, c,, steps,10, 1 ! Example Matrix  
*SET,enow , 0   
*do, ct, 1, 10  
*do, ct2, 1, 10 
*SET,c(ct,ct2) , ct*ct2 
*enddo  
*enddo  
! *** loop to restart the calculation ***   
!------------------------------------------------   
*do,j,1,steps,1 
/com,  %j%  %meshsize%  
*SET,results(j,1) , meshsize
parsav,all  
finish  
/clear,start
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       13:58:26
/input,start,ans,'C:\Program Files\ANSYS Inc\v201\ANSYS\apdl\'  
parres  
/prep7  
blc4,0,0,10,10  
blc4,5,0,5,5
asba,1,2
ET,1,PLANE182   
KEYOPT,1,1,0
KEYOPT,1,3,3
KEYOPT,1,6,0
r,1,0.2 
mp,ex,1,30000000
mp,prxy,1,0.2   
dl,9,,all   
sfl,3,pres,250  
esize,meshsize  
amesh,all   
cpintf,all  
FINISH  
/SOL
solve   
FINISH  
/POST1  
! maximale Verschiebung bei 10;10   
allsel  
nsel,s,loc,x,10 
nsel,r,loc,y,10 
*get,u,NODE,NDNEXT(0),u,y   
*SET,results(j,3) , u   
PATH,hori,2,30,5000 
PPATH,1,0,0,3,,0,   
PPATH,2,0,5,3,,0,   
PDEF,sy,S,Y,NOAVG   
PCALC,INTG,intsy,SY,XG,1,   
PAGET,array_hori,TABL   
*SET,syh,array_hori(5001,6) 
*DEL,array_hori 
*SET,results(j,4),syh   
allsel  
*get,nn,NODE,0,count
*SET,results(j,2),nn*2  
!! Netzgroesse anpassen 
*SET,meshsize , meshsize/verfein
*enddo  
/COM,ANSYS RELEASE 2020 R1           BUILD 20.1      UP20191203       13:58:29
*do,j,1,steps,1 
/com,  %j%   %results(j,1)%   %results(j,2)%   %results(j,3)%   %results(j,4)%   %results(j,5)%   %results(j,6)%
*enddo  
/gcol,1,max_u   
*VPLOT,results(1,2),results(1,3)
weiter=1
/gcol,1,GG  
*VPLOT,results(1,2),results(1,4)
weiter=1
*do,j,1,steps,1 
/com,  %j%   %results(j,1)%   %results(j,2)%   %results(j,3)%   %results(j,4)%   %results(j,5)%   %results(j,6)%
*enddo  
*dmat, exportmatrix, D, import, APDL, result ! export to matrix file
